<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Mwananchi Credit - Loan Request</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    }
    .gradient-bg {
      background: linear-gradient(135deg, #0b1d51, #003366);
    }
    .orange-btn {
      background-color: #ff7f27;
    }
  </style>
</head>
<body class="gradient-bg min-h-screen flex flex-col text-white">

  <!-- Header -->
  <header class="flex items-center p-4 border-b border-orange-400">
    <img src="mwananchi-logo.png" alt="Mwananchi Credit Logo" class="h-10 mr-3">
    <h1 class="text-xl font-bold">Mwananchi Credit</h1>
  </header>

  <!-- Content -->
  <main class="flex-grow p-6">
    <h2 class="text-2xl font-bold mb-4">Loan Request</h2>
    <p class="mb-6 text-orange-300">Your loan limit is determined instantly.</p>

    <!-- Loan Limit Display -->
    <div id="loanLimitBox" class="bg-white text-blue-900 rounded-xl p-6 shadow-lg mb-8">
      <h3 class="text-lg font-semibold">Your Loan Limit:</h3>
      <p id="loanLimit" class="text-4xl font-bold mt-2">Loading...</p>
    </div>

    <!-- Loan Amount Slider -->
    <div class="mb-8">
      <label for="loanAmount" class="block mb-2">Select Loan Amount:</label>
      <input type="range" id="loanAmount" min="1000" max="50000" step="100" class="w-full">
      <p class="mt-2">Selected: <span id="selectedAmount">Ksh 1000</span></p>
    </div>

    <!-- Loan Breakdown -->
    <div class="bg-white text-blue-900 rounded-xl p-6 shadow-lg mb-8">
      <h3 class="text-lg font-semibold mb-4">Loan Breakdown</h3>
      <p>Loan Amount: <span id="breakAmount">Ksh 1000</span></p>
      <p>Interest (10%): <span id="breakInterest">Ksh 100</span></p>
      <p>Service Fee (6.2%): <span id="breakFee">Ksh 62</span></p>
      <hr class="my-2">
      <p class="font-bold">Total Payable: <span id="breakTotal">Ksh 1162</span></p>
    </div>

    <!-- Request Button -->
    <button id="requestLoan" class="orange-btn w-full py-3 text-lg font-bold rounded-lg shadow-lg">Request Loan</button>
  </main>

  <!-- Script -->
  <script>
    // Generate random loan limit (80% chance below 5k)
    function generateLoanLimit() {
      let limit;
      if (Math.random() < 0.8) {
        limit = Math.floor(Math.random() * (5000 - 1000 + 1)) + 1000;
      } else {
        limit = Math.floor(Math.random() * (50000 - 5000 + 1)) + 5000;
      }
      return limit;
    }

    // Display loan limit
    const loanLimit = generateLoanLimit();
    document.getElementById('loanLimit').textContent = `Ksh ${loanLimit.toLocaleString()}`;

    // Initialize slider with limit
    const slider = document.getElementById('loanAmount');
    const selectedAmount = document.getElementById('selectedAmount');
    const breakAmount = document.getElementById('breakAmount');
    const breakInterest = document.getElementById('breakInterest');
    const breakFee = document.getElementById('breakFee');
    const breakTotal = document.getElementById('breakTotal');

    slider.max = loanLimit;
    slider.value = 1000;

    function updateBreakdown() {
      let amount = parseInt(slider.value);
      selectedAmount.textContent = `Ksh ${amount.toLocaleString()}`;
      breakAmount.textContent = `Ksh ${amount.toLocaleString()}`;
      let interest = Math.round(amount * 0.10);
      let fee = Math.round(amount * 0.062);
      breakInterest.textContent = `Ksh ${interest.toLocaleString()}`;
      breakFee.textContent = `Ksh ${fee.toLocaleString()}`;
      breakTotal.textContent = `Ksh ${(amount + interest + fee).toLocaleString()}`;
    }

    slider.addEventListener('input', updateBreakdown);
    updateBreakdown();

    // Store loan request in localStorage
    document.getElementById('requestLoan').addEventListener('click', () => {
      const loanData = {
        limit: loanLimit,
        amount: parseInt(slider.value),
        interest: Math.round(slider.value * 0.10),
        fee: Math.round(slider.value * 0.062),
        total: parseInt(slider.value) + Math.round(slider.value * 0.10) + Math.round(slider.value * 0.062)
      };
      localStorage.setItem('loanRequest', JSON.stringify(loanData));
      window.location.href = 'verification.html';
    });
  </script>

</body>
</html>
