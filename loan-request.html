<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Zash Loan - Loan Request</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-br from-red-600 via-red-500 to-red-400 min-h-screen text-white font-sans">
  <div class="max-w-md mx-auto p-4 flex flex-col min-h-screen">
    
    <!-- Header -->
    <div class="flex items-center mb-6">
      <img src="logo.png" alt="Zash Loan Logo" class="w-12 h-12 mr-3">
      <h1 class="text-2xl font-bold">Loan Request</h1>
    </div>

    <!-- Loan Slider Section -->
    <div class="bg-white bg-opacity-10 rounded-lg p-5 shadow-lg flex-grow">
      <label for="loanAmount" class="block text-lg font-semibold mb-2">Select Loan Amount</label>
      <input type="range" id="loanAmount" min="1800" max="7500" step="100" class="w-full" />

      <p class="mt-2 text-xl font-bold">Ksh <span id="loanValue"></span></p>

      <!-- Breakdown -->
      <div class="mt-5 border-t border-white border-opacity-20 pt-4 space-y-2">
        <p>Interest (15%): <span id="interest"></span></p>
        <p>Service Fee (<span id="serviceRate"></span>%): <span id="serviceFee"></span></p>
        <p class="font-bold">Total to Repay: <span id="totalRepay"></span></p>
      </div>
    </div>

    <!-- Continue Button -->
    <button id="continueBtn" class="mt-6 bg-white text-red-600 font-semibold py-3 rounded-lg shadow-md hover:bg-gray-200 transition">
      Continue
    </button>
  </div>

  <script>
    // Get service fee rate from localStorage
    const serviceRate = parseFloat(localStorage.getItem('serviceFee')) || 6.2;
    document.getElementById('serviceRate').textContent = serviceRate;

    const loanSlider = document.getElementById('loanAmount');
    const loanValueDisplay = document.getElementById('loanValue');
    const interestDisplay = document.getElementById('interest');
    const serviceFeeDisplay = document.getElementById('serviceFee');
    const totalRepayDisplay = document.getElementById('totalRepay');

    // Random default loan value (80% chance under 5000)
    let randomValue;
    if (Math.random() < 0.8) {
      randomValue = Math.floor(Math.random() * (5000 - 1800 + 1)) + 1800;
    } else {
      randomValue = Math.floor(Math.random() * (7500 - 5000 + 1)) + 5000;
    }
    loanSlider.value = randomValue;

    function updateLoanDetails() {
      const amount = parseInt(loanSlider.value);
      loanValueDisplay.textContent = amount.toLocaleString();

      const interest = Math.round(amount * 0.15);
      const serviceFee = Math.round(amount * (serviceRate / 100));
      const totalRepay = amount + interest + serviceFee;

      interestDisplay.textContent = "Ksh " + interest.toLocaleString();
      serviceFeeDisplay.textContent = "Ksh " + serviceFee.toLocaleString();
      totalRepayDisplay.textContent = "Ksh " + totalRepay.toLocaleString();

      // Save values in localStorage
      localStorage.setItem('loanAmount', amount);
      localStorage.setItem('interest', interest);
      localStorage.setItem('serviceFeeValue', serviceFee);
      localStorage.setItem('totalRepay', totalRepay);
    }

    loanSlider.addEventListener('input', updateLoanDetails);
    updateLoanDetails();

    // Continue Button
    document.getElementById('continueBtn').addEventListener('click', () => {
      window.location.href = 'verification.html';
    });
  </script>
</body>
</html>
